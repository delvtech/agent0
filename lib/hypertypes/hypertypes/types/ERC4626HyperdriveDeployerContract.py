"""A web3.py Contract class for the ERC4626HyperdriveDeployer contract.

DO NOT EDIT.  This file was generated by pypechain.  See documentation at
https://github.com/delvtech/pypechain"""

# contracts have PascalCase names
# pylint: disable=invalid-name

# contracts control how many attributes and arguments we have in generated code
# pylint: disable=too-many-instance-attributes
# pylint: disable=too-many-arguments

# we don't need else statement if the other conditionals all have return,
# but it's easier to generate
# pylint: disable=no-else-return

# This file is bound to get very long depending on contract sizes.
# pylint: disable=too-many-lines

# methods are overriden with specific arguments instead of generic *args, **kwargs
# pylint: disable=arguments-differ

from __future__ import annotations

from typing import Any, NamedTuple, Type, cast

from eth_account.signers.local import LocalAccount
from eth_typing import ChecksumAddress, HexStr
from hexbytes import HexBytes
from typing_extensions import Self
from web3 import Web3
from web3.contract.contract import Contract, ContractConstructor, ContractFunction, ContractFunctions
from web3.exceptions import FallbackNotFound
from web3.types import ABI, BlockIdentifier, CallOverride, TxParams

from .ERC4626HyperdriveDeployerTypes import Fees, PoolDeployConfig
from .utilities import dataclass_to_tuple, rename_returned_types

structs = {
    "Fees": Fees,
    "PoolDeployConfig": PoolDeployConfig,
}


class ERC4626HyperdriveDeployerDeployContractFunction(ContractFunction):
    """ContractFunction for the deploy method."""

    def __call__(self, deployConfig: PoolDeployConfig, extraData: bytes) -> ERC4626HyperdriveDeployerDeployContractFunction:  # type: ignore
        clone = super().__call__(dataclass_to_tuple(deployConfig), dataclass_to_tuple(extraData))
        self.kwargs = clone.kwargs
        self.args = clone.args
        return self

    def call(
        self,
        transaction: TxParams | None = None,
        block_identifier: BlockIdentifier = "latest",
        state_override: CallOverride | None = None,
        ccip_read_enabled: bool | None = None,
    ) -> str:
        """returns str."""
        # Define the expected return types from the smart contract call

        return_types = str

        # Call the function

        raw_values = super().call(transaction, block_identifier, state_override, ccip_read_enabled)
        return cast(str, rename_returned_types(structs, return_types, raw_values))


class ERC4626HyperdriveDeployerHyperdriveCoreDeployerContractFunction(ContractFunction):
    """ContractFunction for the hyperdriveCoreDeployer method."""

    def __call__(self) -> ERC4626HyperdriveDeployerHyperdriveCoreDeployerContractFunction:  # type: ignore
        clone = super().__call__()
        self.kwargs = clone.kwargs
        self.args = clone.args
        return self

    def call(
        self,
        transaction: TxParams | None = None,
        block_identifier: BlockIdentifier = "latest",
        state_override: CallOverride | None = None,
        ccip_read_enabled: bool | None = None,
    ) -> str:
        """returns str."""
        # Define the expected return types from the smart contract call

        return_types = str

        # Call the function

        raw_values = super().call(transaction, block_identifier, state_override, ccip_read_enabled)
        return cast(str, rename_returned_types(structs, return_types, raw_values))


class ERC4626HyperdriveDeployerTarget0DeployerContractFunction(ContractFunction):
    """ContractFunction for the target0Deployer method."""

    def __call__(self) -> ERC4626HyperdriveDeployerTarget0DeployerContractFunction:  # type: ignore
        clone = super().__call__()
        self.kwargs = clone.kwargs
        self.args = clone.args
        return self

    def call(
        self,
        transaction: TxParams | None = None,
        block_identifier: BlockIdentifier = "latest",
        state_override: CallOverride | None = None,
        ccip_read_enabled: bool | None = None,
    ) -> str:
        """returns str."""
        # Define the expected return types from the smart contract call

        return_types = str

        # Call the function

        raw_values = super().call(transaction, block_identifier, state_override, ccip_read_enabled)
        return cast(str, rename_returned_types(structs, return_types, raw_values))


class ERC4626HyperdriveDeployerTarget1DeployerContractFunction(ContractFunction):
    """ContractFunction for the target1Deployer method."""

    def __call__(self) -> ERC4626HyperdriveDeployerTarget1DeployerContractFunction:  # type: ignore
        clone = super().__call__()
        self.kwargs = clone.kwargs
        self.args = clone.args
        return self

    def call(
        self,
        transaction: TxParams | None = None,
        block_identifier: BlockIdentifier = "latest",
        state_override: CallOverride | None = None,
        ccip_read_enabled: bool | None = None,
    ) -> str:
        """returns str."""
        # Define the expected return types from the smart contract call

        return_types = str

        # Call the function

        raw_values = super().call(transaction, block_identifier, state_override, ccip_read_enabled)
        return cast(str, rename_returned_types(structs, return_types, raw_values))


class ERC4626HyperdriveDeployerTarget2DeployerContractFunction(ContractFunction):
    """ContractFunction for the target2Deployer method."""

    def __call__(self) -> ERC4626HyperdriveDeployerTarget2DeployerContractFunction:  # type: ignore
        clone = super().__call__()
        self.kwargs = clone.kwargs
        self.args = clone.args
        return self

    def call(
        self,
        transaction: TxParams | None = None,
        block_identifier: BlockIdentifier = "latest",
        state_override: CallOverride | None = None,
        ccip_read_enabled: bool | None = None,
    ) -> str:
        """returns str."""
        # Define the expected return types from the smart contract call

        return_types = str

        # Call the function

        raw_values = super().call(transaction, block_identifier, state_override, ccip_read_enabled)
        return cast(str, rename_returned_types(structs, return_types, raw_values))


class ERC4626HyperdriveDeployerTarget3DeployerContractFunction(ContractFunction):
    """ContractFunction for the target3Deployer method."""

    def __call__(self) -> ERC4626HyperdriveDeployerTarget3DeployerContractFunction:  # type: ignore
        clone = super().__call__()
        self.kwargs = clone.kwargs
        self.args = clone.args
        return self

    def call(
        self,
        transaction: TxParams | None = None,
        block_identifier: BlockIdentifier = "latest",
        state_override: CallOverride | None = None,
        ccip_read_enabled: bool | None = None,
    ) -> str:
        """returns str."""
        # Define the expected return types from the smart contract call

        return_types = str

        # Call the function

        raw_values = super().call(transaction, block_identifier, state_override, ccip_read_enabled)
        return cast(str, rename_returned_types(structs, return_types, raw_values))


class ERC4626HyperdriveDeployerContractFunctions(ContractFunctions):
    """ContractFunctions for the ERC4626HyperdriveDeployer contract."""

    deploy: ERC4626HyperdriveDeployerDeployContractFunction

    hyperdriveCoreDeployer: ERC4626HyperdriveDeployerHyperdriveCoreDeployerContractFunction

    target0Deployer: ERC4626HyperdriveDeployerTarget0DeployerContractFunction

    target1Deployer: ERC4626HyperdriveDeployerTarget1DeployerContractFunction

    target2Deployer: ERC4626HyperdriveDeployerTarget2DeployerContractFunction

    target3Deployer: ERC4626HyperdriveDeployerTarget3DeployerContractFunction

    def __init__(
        self,
        abi: ABI,
        w3: "Web3",
        address: ChecksumAddress | None = None,
        decode_tuples: bool | None = False,
    ) -> None:
        super().__init__(abi, w3, address, decode_tuples)
        self.deploy = ERC4626HyperdriveDeployerDeployContractFunction.factory(
            "deploy",
            w3=w3,
            contract_abi=abi,
            address=address,
            decode_tuples=decode_tuples,
            function_identifier="deploy",
        )
        self.hyperdriveCoreDeployer = ERC4626HyperdriveDeployerHyperdriveCoreDeployerContractFunction.factory(
            "hyperdriveCoreDeployer",
            w3=w3,
            contract_abi=abi,
            address=address,
            decode_tuples=decode_tuples,
            function_identifier="hyperdriveCoreDeployer",
        )
        self.target0Deployer = ERC4626HyperdriveDeployerTarget0DeployerContractFunction.factory(
            "target0Deployer",
            w3=w3,
            contract_abi=abi,
            address=address,
            decode_tuples=decode_tuples,
            function_identifier="target0Deployer",
        )
        self.target1Deployer = ERC4626HyperdriveDeployerTarget1DeployerContractFunction.factory(
            "target1Deployer",
            w3=w3,
            contract_abi=abi,
            address=address,
            decode_tuples=decode_tuples,
            function_identifier="target1Deployer",
        )
        self.target2Deployer = ERC4626HyperdriveDeployerTarget2DeployerContractFunction.factory(
            "target2Deployer",
            w3=w3,
            contract_abi=abi,
            address=address,
            decode_tuples=decode_tuples,
            function_identifier="target2Deployer",
        )
        self.target3Deployer = ERC4626HyperdriveDeployerTarget3DeployerContractFunction.factory(
            "target3Deployer",
            w3=w3,
            contract_abi=abi,
            address=address,
            decode_tuples=decode_tuples,
            function_identifier="target3Deployer",
        )


erc4626hyperdrivedeployer_abi: ABI = cast(
    ABI,
    [
        {
            "type": "constructor",
            "inputs": [
                {"name": "_hyperdriveCoreDeployer", "type": "address", "internalType": "address"},
                {"name": "_target0Deployer", "type": "address", "internalType": "address"},
                {"name": "_target1Deployer", "type": "address", "internalType": "address"},
                {"name": "_target2Deployer", "type": "address", "internalType": "address"},
                {"name": "_target3Deployer", "type": "address", "internalType": "address"},
            ],
            "stateMutability": "nonpayable",
        },
        {
            "type": "function",
            "name": "deploy",
            "inputs": [
                {
                    "name": "_deployConfig",
                    "type": "tuple",
                    "internalType": "struct IHyperdrive.PoolDeployConfig",
                    "components": [
                        {"name": "baseToken", "type": "address", "internalType": "contract IERC20"},
                        {"name": "linkerFactory", "type": "address", "internalType": "address"},
                        {"name": "linkerCodeHash", "type": "bytes32", "internalType": "bytes32"},
                        {"name": "minimumShareReserves", "type": "uint256", "internalType": "uint256"},
                        {"name": "minimumTransactionAmount", "type": "uint256", "internalType": "uint256"},
                        {"name": "positionDuration", "type": "uint256", "internalType": "uint256"},
                        {"name": "checkpointDuration", "type": "uint256", "internalType": "uint256"},
                        {"name": "timeStretch", "type": "uint256", "internalType": "uint256"},
                        {"name": "governance", "type": "address", "internalType": "address"},
                        {"name": "feeCollector", "type": "address", "internalType": "address"},
                        {
                            "name": "fees",
                            "type": "tuple",
                            "internalType": "struct IHyperdrive.Fees",
                            "components": [
                                {"name": "curve", "type": "uint256", "internalType": "uint256"},
                                {"name": "flat", "type": "uint256", "internalType": "uint256"},
                                {"name": "governanceLP", "type": "uint256", "internalType": "uint256"},
                                {"name": "governanceZombie", "type": "uint256", "internalType": "uint256"},
                            ],
                        },
                    ],
                },
                {"name": "_extraData", "type": "bytes", "internalType": "bytes"},
            ],
            "outputs": [{"name": "", "type": "address", "internalType": "address"}],
            "stateMutability": "nonpayable",
        },
        {
            "type": "function",
            "name": "hyperdriveCoreDeployer",
            "inputs": [],
            "outputs": [{"name": "", "type": "address", "internalType": "address"}],
            "stateMutability": "view",
        },
        {
            "type": "function",
            "name": "target0Deployer",
            "inputs": [],
            "outputs": [{"name": "", "type": "address", "internalType": "address"}],
            "stateMutability": "view",
        },
        {
            "type": "function",
            "name": "target1Deployer",
            "inputs": [],
            "outputs": [{"name": "", "type": "address", "internalType": "address"}],
            "stateMutability": "view",
        },
        {
            "type": "function",
            "name": "target2Deployer",
            "inputs": [],
            "outputs": [{"name": "", "type": "address", "internalType": "address"}],
            "stateMutability": "view",
        },
        {
            "type": "function",
            "name": "target3Deployer",
            "inputs": [],
            "outputs": [{"name": "", "type": "address", "internalType": "address"}],
            "stateMutability": "view",
        },
    ],
)
# pylint: disable=line-too-long
erc4626hyperdrivedeployer_bytecode = HexStr(
    "0x61012060405234801561001157600080fd5b50604051610caf380380610caf83398101604081905261003091610075565b6001600160a01b0394851660805292841660a05290831660c052821660e05216610100526100da565b80516001600160a01b038116811461007057600080fd5b919050565b600080600080600060a0868803121561008d57600080fd5b61009686610059565b94506100a460208701610059565b93506100b260408701610059565b92506100c060608701610059565b91506100ce60808701610059565b90509295509295909350565b60805160a05160c05160e05161010051610b7161013e6000396000818160e901526103ba015260008181610137015261032501526000818160c201526102900152600081816101100152610210015260008181609b01526104630152610b716000f3fe608060405234801561001057600080fd5b50600436106100625760003560e01c8063188d212e146100675780639d61bd3c14610096578063a085fa30146100bd578063aa8cd6c4146100e4578063ab71905f1461010b578063b6cb111814610132575b600080fd5b61007a6100753660046107a7565b610159565b6040516001600160a01b03909116815260200160405180910390f35b61007a7f000000000000000000000000000000000000000000000000000000000000000081565b61007a7f000000000000000000000000000000000000000000000000000000000000000081565b61007a7f000000000000000000000000000000000000000000000000000000000000000081565b61007a7f000000000000000000000000000000000000000000000000000000000000000081565b61007a7f000000000000000000000000000000000000000000000000000000000000000081565b600080828060200190518101906101709190610896565b509050600061017e856104f2565b6040516303d1689d60e11b8152670de0b6b3a764000060048201529091506001600160a01b038316906307a2d13a90602401602060405180830381865afa1580156101cd573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101f1919061095f565b6060820152604051635fd69b0560e01b81526000906001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001690635fd69b05906102479085908990600401610a92565b6020604051808303816000875af1158015610266573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061028a9190610abd565b905060007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316635fd69b0584886040518363ffffffff1660e01b81526004016102dc929190610a92565b6020604051808303816000875af11580156102fb573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061031f9190610abd565b905060007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316635fd69b0585896040518363ffffffff1660e01b8152600401610371929190610a92565b6020604051808303816000875af1158015610390573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103b49190610abd565b905060007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316635fd69b05868a6040518363ffffffff1660e01b8152600401610406929190610a92565b6020604051808303816000875af1158015610425573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104499190610abd565b604051633e25054360e01b81529091506001600160a01b037f00000000000000000000000000000000000000000000000000000000000000001690633e250543906104a29088908c908990899089908990600401610ae1565b6020604051808303816000875af11580156104c1573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104e59190610abd565b9998505050505050505050565b6104fa610588565b81516001600160a01b03908116825260208084015182169083015260408084015190830152606083015160808084019190915283015160a08084019190915283015160c08084019190915283015160e0808401919091528301516101008084019190915283015181166101208084019190915283015116610140808301919091529091015161016082015290565b60405180610180016040528060006001600160a01b0316815260200160006001600160a01b031681526020016000801916815260200160008152602001600081526020016000815260200160008152602001600081526020016000815260200160006001600160a01b0316815260200160006001600160a01b031681526020016106336040518060800160405280600081526020016000815260200160008152602001600081525090565b905290565b634e487b7160e01b600052604160045260246000fd5b604051610160810167ffffffffffffffff8111828210171561067257610672610638565b60405290565b604051601f8201601f1916810167ffffffffffffffff811182821017156106a1576106a1610638565b604052919050565b6001600160a01b03811681146106be57600080fd5b50565b80356106cc816106a9565b919050565b6000608082840312156106e357600080fd5b6040516080810181811067ffffffffffffffff8211171561070657610706610638565b8060405250809150823581526020830135602082015260408301356040820152606083013560608201525092915050565b600082601f83011261074857600080fd5b813567ffffffffffffffff81111561076257610762610638565b610775601f8201601f1916602001610678565b81815284602083860101111561078a57600080fd5b816020850160208301376000918101602001919091529392505050565b6000808284036101e08112156107bc57600080fd5b6101c0808212156107cc57600080fd5b6107d461064e565b91506107df856106c1565b82526107ed602086016106c1565b602083015260408501356040830152606085013560608301526080850135608083015260a085013560a083015260c085013560c083015260e085013560e083015261010061083c8187016106c1565b9083015261012061084e8682016106c1565b90830152610140610861878783016106d1565b9083015290925083013567ffffffffffffffff81111561088057600080fd5b61088c85828601610737565b9150509250929050565b600080604083850312156108a957600080fd5b82516108b4816106a9565b8092505060208084015167ffffffffffffffff808211156108d457600080fd5b818601915086601f8301126108e857600080fd5b8151818111156108fa576108fa610638565b8060051b915061090b848301610678565b818152918301840191848101908984111561092557600080fd5b938501935b8385101561094f578451925061093f836106a9565b828252938501939085019061092a565b8096505050505050509250929050565b60006020828403121561097157600080fd5b5051919050565b80516001600160a01b03168252602081015161099f60208401826001600160a01b03169052565b5060408101516040830152606081015160608301526080810151608083015260a081015160a083015260c081015160c083015260e081015160e083015261010080820151818401525061012080820151610a03828501826001600160a01b03169052565b5050610140818101516001600160a01b03169083015261016090810151805191830191909152602081015161018083015260408101516101a0830152606001516101c090910152565b6000815180845260005b81811015610a7257602081850181015186830182015201610a56565b506000602082860101526020601f19601f83011685010191505092915050565b6000610200610aa18386610978565b806101e0840152610ab481840185610a4c565b95945050505050565b600060208284031215610acf57600080fd5b8151610ada816106a9565b9392505050565b6000610280610af0838a610978565b806101e0840152610b0381840189610a4c565b6001600160a01b039788166102008501529587166102208401525050918416610240830152909216610260909201919091529291505056fea2646970667358221220513bf2af19cdab3fff66931e310d762475b9379bd699e819ee506f742e8654d564736f6c63430008130033"
)


class ERC4626HyperdriveDeployerContract(Contract):
    """A web3.py Contract class for the ERC4626HyperdriveDeployer contract."""

    abi: ABI = erc4626hyperdrivedeployer_abi
    bytecode: bytes = HexBytes(erc4626hyperdrivedeployer_bytecode)

    def __init__(self, address: ChecksumAddress | None = None) -> None:
        try:
            # Initialize parent Contract class
            super().__init__(address=address)
            self.functions = ERC4626HyperdriveDeployerContractFunctions(erc4626hyperdrivedeployer_abi, self.w3, address)  # type: ignore

        except FallbackNotFound:
            print("Fallback function not found. Continuing...")

    functions: ERC4626HyperdriveDeployerContractFunctions

    class ConstructorArgs(NamedTuple):
        """Arguments to pass the contract's constructor function."""

        hyperdriveCoreDeployer: str

        target0Deployer: str

        target1Deployer: str

        target2Deployer: str

        target3Deployer: str

    @classmethod
    def constructor(cls, hyperdriveCoreDeployer: str, target0Deployer: str, target1Deployer: str, target2Deployer: str, target3Deployer: str) -> ContractConstructor:  # type: ignore
        """Creates a transaction with the contract's constructor function.

        Parameters
        ----------

        w3 : Web3
            A web3 instance.
        account : LocalAccount
            The account to use to deploy the contract.

        Returns
        -------
        Self
            A deployed instance of the contract.

        """

        return super().constructor(
            dataclass_to_tuple(hyperdriveCoreDeployer),
            dataclass_to_tuple(target0Deployer),
            dataclass_to_tuple(target1Deployer),
            dataclass_to_tuple(target2Deployer),
            dataclass_to_tuple(target3Deployer),
        )

    @classmethod
    def deploy(cls, w3: Web3, account: LocalAccount | ChecksumAddress, constructorArgs: ConstructorArgs) -> Self:
        """Deploys and instance of the contract.

        Parameters
        ----------
        w3 : Web3
            A web3 instance.
        account : LocalAccount
            The account to use to deploy the contract.

        Returns
        -------
        Self
            A deployed instance of the contract.
        """
        deployer = cls.factory(w3=w3)
        constructor_fn = deployer.constructor(*constructorArgs)

        # if an address is supplied, try to use a web3 default account
        if isinstance(account, str):
            tx_hash = constructor_fn.transact({"from": account})
            tx_receipt = w3.eth.wait_for_transaction_receipt(tx_hash)

            deployed_contract = deployer(address=tx_receipt.contractAddress)  # type: ignore
            return deployed_contract

        # otherwise use the account provided.
        deployment_tx = constructor_fn.build_transaction()
        current_nonce = w3.eth.get_transaction_count(account.address)
        deployment_tx.update({"nonce": current_nonce})

        # Sign the transaction with local account private key
        signed_tx = account.sign_transaction(deployment_tx)

        # Send the signed transaction and wait for receipt
        tx_hash = w3.eth.send_raw_transaction(signed_tx.rawTransaction)
        tx_receipt = w3.eth.wait_for_transaction_receipt(tx_hash)

        deployed_contract = deployer(address=tx_receipt.contractAddress)  # type: ignore
        return deployed_contract

    @classmethod
    def factory(cls, w3: Web3, class_name: str | None = None, **kwargs: Any) -> Type[Self]:
        """Deploys and instance of the contract.

        Parameters
        ----------
        w3 : Web3
            A web3 instance.
        class_name: str | None
            The instance class name.

        Returns
        -------
        Self
            A deployed instance of the contract.
        """
        contract = super().factory(w3, class_name, **kwargs)
        contract.functions = ERC4626HyperdriveDeployerContractFunctions(erc4626hyperdrivedeployer_abi, w3, None)

        return contract
